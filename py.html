<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Çµ„Ç§„Ç≥„É≠„ÅÆÁ¢∫ÁéáÂèéÊùü„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --accent-color: #e74c3c;
            --background-color: #f5f7fa;
            --card-color: #ffffff;
            --text-color: #2c3e50;
            --text-light: #7f8c8d;
            --border-radius: 12px;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Meiryo', sans-serif;
        }
        
        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            padding: 2rem;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }
        
        .card {
            background-color: var(--card-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 2rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        h1 {
            color: var(--primary-color);
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
            font-weight: 800;
            letter-spacing: -0.025em;
        }
        
        h2 {
            color: var(--secondary-color);
            font-size: 1.8rem;
            margin: 1.5rem 0 1rem;
            font-weight: 700;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 0.5rem;
        }
        
        h3 {
            color: var(--text-color);
            font-size: 1.4rem;
            margin: 1rem 0;
            font-weight: 600;
        }
        
        .control-panel {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background-color 0.3s, transform 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        input {
            padding: 0.75rem;
            border: 1px solid #e5e7eb;
            border-radius: var(--border-radius);
            width: 120px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        label {
            font-weight: 600;
            color: var(--text-color);
        }
        
        .results {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }
        
        @media (max-width: 768px) {
            .results {
                grid-template-columns: 1fr;
            }
        }
        
        .chart-container {
            height: 500px;
            position: relative;
        }
        
        .stats {
            background-color: #f8f9fa;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
        }
        
        .code-section {
            margin-top: 3rem;
        }
        
        pre {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            overflow-x: auto;
            font-family: 'Consolas', 'Courier New', monospace;
            line-height: 1.4;
            margin: 1.5rem 0;
        }
        
        code {
            font-family: 'Consolas', 'Courier New', monospace;
        }
        
        .explanation {
            background-color: #eaf2f8;
            padding: 1.5rem;
            border-left: 4px solid var(--primary-color);
            margin: 1.5rem 0;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }
        
        .section {
            margin-bottom: 2.5rem;
            animation: fadeIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .dice-container {
            display: flex;
            justify-content: center;
            margin: 2rem 0;
        }
        
        .dice {
            width: 80px;
            height: 80px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            padding: 10px;
            position: relative;
            transition: transform 0.5s ease;
        }
        
        .dot {
            width: 12px;
            height: 12px;
            background-color: #333;
            border-radius: 50%;
            align-self: center;
            justify-self: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .rolling {
            animation: roll 1s ease-out;
        }
        
        @keyframes roll {
            0% { transform: rotateX(0) rotateY(0) rotateZ(0); }
            25% { transform: rotateX(90deg) rotateY(45deg) rotateZ(180deg); }
            50% { transform: rotateX(270deg) rotateY(90deg) rotateZ(0); }
            75% { transform: rotateX(180deg) rotateY(315deg) rotateZ(90deg); }
            100% { transform: rotateX(360deg) rotateY(360deg) rotateZ(360deg); }
        }
        
        .icon {
            display: inline-block;
            margin-right: 0.5rem;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }
        
        @media (max-width: 640px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }
        
        .probability-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        
        .probability-table th, .probability-table td {
            padding: 0.75rem;
            text-align: center;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .probability-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        .probability-table tr:hover {
            background-color: #f8f9fa;
        }
        
        .theoretical {
            color: var(--accent-color);
            font-weight: 600;
        }
        
        .progress-bar {
            height: 4px;
            background-color: #e5e7eb;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 1rem;
        }
        
        .progress {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>„Çµ„Ç§„Ç≥„É≠„ÅÆÁ¢∫ÁéáÂèéÊùü„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</h1>
        
        <div class="card section">
            <h2><span class="icon">üé≤</span>„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</h2>
            
            <div class="control-panel">
                <label for="trials">Ë©¶Ë°åÂõûÊï∞:</label>
                <input type="number" id="trials" min="10" max="10000" value="1000">
                <button id="run-btn"><span class="icon"‚ñ∂Ô∏è</span>ÂÆüË°å</button>
                <button id="reset-btn"><span class="icon">üîÑ</span>„É™„Çª„ÉÉ„Éà</button>
            </div>
            
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
            
            <div class="dice-container">
                <div class="dice" id="dice">
                    <div class="dot" id="dot1"></div>
                    <div class="dot" id="dot2"></div>
                    <div class="dot" id="dot3"></div>
                    <div class="dot" id="dot4"></div>
                    <div class="dot" id="dot5"></div>
                    <div class="dot" id="dot6"></div>
                    <div class="dot" id="dot7"></div>
                    <div class="dot" id="dot8"></div>
                    <div class="dot" id="dot9"></div>
                </div>
            </div>
            
            <div class="results">
                <div class="chart-container">
                    <canvas id="results-chart"></canvas>
                </div>
                <div class="stats" id="stats-container">
                    <h3>Á¢∫ÁéáÁµ±Ë®à</h3>
                    <p>„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                </div>
            </div>
        </div>
        
        <div class="card code-section">
            <h2><span class="icon">üíª</span>Python„Ç≥„Éº„Éâ„ÅÆËß£Ë™¨</h2>
            
            <div class="explanation">
                <p>‰ª•‰∏ã„ÅÆPython„Ç≥„Éº„Éâ„ÅØ„ÄÅ„Çµ„Ç§„Ç≥„É≠„ÇíÊåØ„Çã„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„ÇíË°å„ÅÑ„ÄÅÂêÑÁõÆ„ÅåÂá∫„ÇãÁ¢∫Áéá„ÅåË©¶Ë°åÂõûÊï∞„ÇíÂ¢ó„ÇÑ„Åô„Å´„Å§„Çå„Å¶ÁêÜË´ñÂÄ§Ôºà1/6Ôºâ„Å´ÂèéÊùü„Åó„Å¶„ÅÑ„ÅèÊßòÂ≠ê„ÇíÂèØË¶ñÂåñ„Åô„Çã„ÇÇ„ÅÆ„Åß„Åô„ÄÇ„Åì„ÅÆWeb„Éö„Éº„Ç∏„Åß„ÅØ„ÄÅÂêå„Åò„É≠„Ç∏„ÉÉ„ÇØ„ÇíJavaScript„ÅßÂÆüË£Ö„Åó„ÄÅ„Ç§„É≥„Çø„É©„ÇØ„ÉÜ„Ç£„Éñ„Å´ÁµêÊûú„ÇíÁ¢∫Ë™ç„Åß„Åç„Çã„Çà„ÅÜ„Å´„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
            </div>
            
            <pre><code>import random

import numpy as np
import matplotlib.pyplot as plt
import japanize_matplotlib


def dice_probability_simulation(trials: int = 1000) -> None:
    # ÁµêÊûú„ÇíË®òÈå≤„Åô„ÇãÈÖçÂàó
    counts = {i: 0 for i in range(1, 7)}
    probabilities = {i: [] for i in range(1, 7)}

    # „Çµ„Ç§„Ç≥„É≠„ÇíÊåØ„Çã„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
    for i in range(1, trials + 1):
        roll = random.randint(1, 6)
        counts[roll] += 1

        # ÂêÑÁõÆ„ÅÆÁ¢∫Áéá„ÇíË®àÁÆó„Åó„Å¶Ë®òÈå≤
        for num in range(1, 7):
            prob = counts[num] / i
            probabilities[num].append(prob)

    # „Ç∞„É©„Éï„ÅÆÊèèÁîª
    plt.figure(figsize=(12, 6))

    # ÂêÑÁõÆ„ÅÆÁ¢∫Áéá„ÅÆÊé®Áßª„Çí„Éó„É≠„ÉÉ„Éà
    for num in range(1, 7):
        plt.plot(probabilities[num], label=f'{num}„ÅÆÁõÆ', alpha=0.7)

    # ÁêÜË´ñÂÄ§ Ôºà1 / 6Ôºâ „ÅÆÁ∑ö„ÇíËøΩÂä†
    plt.axhline(y=1 / 6, color='r', linestyle='--', label='ÁêÜË´ñÂÄ§ (1 / 6)')

    plt.xlabel('Ë©¶Ë°åÂõûÊï∞')
    plt.ylabel('Á¢∫Áéá')
    plt.title('„Çµ„Ç§„Ç≥„É≠„ÅÆÁ¢∫ÁéáÂèéÊùü„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥')
    plt.legend()
    plt.grid(True)
    plt.show()

    # ÊúÄÁµÇÁöÑ„Å™Á¢∫Áéá„ÇíË°®Á§∫
    print("\nÊúÄÁµÇÁöÑ„Å™Á¢∫Áéá:")
    for num in range(1, 7):
        final_prob = probabilities[num][-1]
        print(f"{num}„ÅÆÁõÆ: {final_prob:.3f}")


dice_probability_simulation(1000)</code></pre>
            
            <div class="section">
                <h2><span class="icon">üìù</span>„Ç≥„Éº„Éâ„ÅÆË©≥Á¥∞Ëß£Ë™¨</h2>
                
                <div class="grid-2">
                    <div>
                        <h3>1. „É©„Ç§„Éñ„É©„É™„ÅÆ„Ç§„É≥„Éù„Éº„Éà</h3>
                        <div class="explanation">
                            <p><code>random</code>: ‰π±Êï∞„ÇíÁîüÊàê„Åô„Çã„Åü„ÇÅ„ÅÆ„É©„Ç§„Éñ„É©„É™„Åß„Åô„ÄÇ„Çµ„Ç§„Ç≥„É≠„ÅÆÁõÆ„Çí„É©„É≥„ÉÄ„É†„Å´Ê±∫ÂÆö„Åô„Çã„Åü„ÇÅ„Å´‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ</p>
                            <p><code>numpy</code>: Êï∞ÂÄ§Ë®àÁÆó„ÅÆ„Åü„ÇÅ„ÅÆ„É©„Ç§„Éñ„É©„É™„Åß„Åô„ÄÇ</p>
                            <p><code>matplotlib.pyplot</code>: „Éá„Éº„Çø„ÅÆÂèØË¶ñÂåñÔºà„Ç∞„É©„Éï‰ΩúÊàêÔºâ„ÅÆ„Åü„ÇÅ„ÅÆ„É©„Ç§„Éñ„É©„É™„Åß„Åô„ÄÇ</p>
                            <p><code>japanize_matplotlib</code>: matplotlib„ÅßÊó•Êú¨Ë™û„ÇíË°®Á§∫„Åô„Çã„Åü„ÇÅ„ÅÆ„É©„Ç§„Éñ„É©„É™„Åß„Åô„ÄÇ</p>
                        </div>
                    </div>
                    
                    <div>
                        <h3>2. dice_probability_simulationÈñ¢Êï∞</h3>
                        <div class="explanation">
                            <p>„Åì„ÅÆÈñ¢Êï∞„ÅØ„ÄÅÊåáÂÆö„Åï„Çå„ÅüÂõûÊï∞„ÅÆ„Çµ„Ç§„Ç≥„É≠Êäï„Åí„Çí„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„Åó„ÄÅÂêÑÁõÆ„ÅÆÂá∫ÁèæÁ¢∫Áéá„ÅÆÊé®Áßª„ÇíË®òÈå≤„ÉªË°®Á§∫„Åó„Åæ„Åô„ÄÇ</p>
                            <p><strong>ÂºïÊï∞</strong>: <code>trials</code> - „Çµ„Ç§„Ç≥„É≠„ÇíÊåØ„ÇãÂõûÊï∞Ôºà„Éá„Éï„Ç©„É´„Éà„ÅØ1000ÂõûÔºâ</p>
                            <p><strong>Êàª„ÇäÂÄ§</strong>: „Å™„ÅóÔºà„Ç∞„É©„Éï„ÇíË°®Á§∫„Åó„ÄÅÊúÄÁµÇÁöÑ„Å™Á¢∫Áéá„ÇíÂá∫ÂäõÔºâ</p>
                        </div>
                    </div>
                </div>
                
                <div class="grid-2">
                    <div>
                        <h3>3. „Çµ„Ç§„Ç≥„É≠„ÇíÊåØ„Çã„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥</h3>
                        <div class="explanation">
                            <p><code>random.randint(1, 6)</code>„Åß1„Åã„Çâ6„Åæ„Åß„ÅÆÊï¥Êï∞„Çí„É©„É≥„ÉÄ„É†„Å´ÁîüÊàê„Åó„ÄÅ„Çµ„Ç§„Ç≥„É≠„ÅÆÁõÆ„Å®„Åó„Åæ„Åô„ÄÇ</p>
                            <p>ÂêÑË©¶Ë°å„Åî„Å®„Å´„ÄÅÂá∫„ÅüÁõÆ„ÅÆÂá∫ÁèæÂõûÊï∞„Çí„Ç´„Ç¶„É≥„Éà„Åó„Åæ„Åô„ÄÇ</p>
                            <p>„Åù„Åó„Å¶„ÄÅÂêÑÁõÆ„Å´„Å§„ÅÑ„Å¶„ÄÅÁèæÂú®„Åæ„Åß„ÅÆË©¶Ë°åÂõûÊï∞„Å´ÂØæ„Åô„ÇãÂá∫ÁèæÂõûÊï∞„ÅÆÂâ≤ÂêàÔºàÁ¢∫ÁéáÔºâ„ÇíË®àÁÆó„ÅóË®òÈå≤„Åó„Åæ„Åô„ÄÇ</p>
                        </div>
                    </div>
                    
                    <div>
                        <h3>4. „Ç∞„É©„Éï„ÅÆÊèèÁîª„Å®ÁµêÊûúË°®Á§∫</h3>
                        <div class="explanation">
                            <p>ÂêÑÁõÆ„ÅÆÁ¢∫Áéá„ÅÆÊé®Áßª„Çí„Ç∞„É©„Éï„Å´„Éó„É≠„ÉÉ„Éà„Åó„Åæ„Åô„ÄÇ</p>
                            <p>ÁêÜË´ñÂÄ§„Åß„ÅÇ„Çã1/6ÔºàÁ¥Ñ0.167Ôºâ„ÇíÊ∞¥Âπ≥Á∑ö„ÅßË°®Á§∫„Åó„Åæ„Åô„ÄÇ</p>
                            <p>ÊúÄÂæå„Å´„ÄÅÊúÄÁµÇÁöÑ„Å™ÂêÑÁõÆ„ÅÆÂá∫ÁèæÁ¢∫Áéá„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ</p>
                        </div>
                    </div>
                </div>
                
                <h3>5. Â§ßÊï∞„ÅÆÊ≥ïÂâá„ÅÆÁ¢∫Ë™ç</h3>
                <div class="explanation">
                    <p>„Åì„ÅÆ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„ÅØ„ÄåÂ§ßÊï∞„ÅÆÊ≥ïÂâá„Äç„ÇíË¶ñË¶öÁöÑ„Å´Á¢∫Ë™ç„Åô„Çã„Åü„ÇÅ„ÅÆ„ÇÇ„ÅÆ„Åß„Åô„ÄÇÂ§ßÊï∞„ÅÆÊ≥ïÂâá„Å®„ÅØ„ÄÅË©¶Ë°åÂõûÊï∞„ÇíÂ¢ó„ÇÑ„Åô„Å®„ÄÅ‰∫ãË±°„ÅÆÂá∫ÁèæÁ¢∫Áéá„ÅåÁêÜË´ñ‰∏ä„ÅÆÁ¢∫Áéá„Å´Ëøë„Å•„Åè„Å®„ÅÑ„ÅÜÊ≥ïÂâá„Åß„Åô„ÄÇ</p>
                    <p>„Çµ„Ç§„Ç≥„É≠„ÅÆÂêÑÁõÆ„ÅåÂá∫„ÇãÁ¢∫Áéá„ÅØÁêÜË´ñÁöÑ„Å´„ÅØ1/6ÔºàÁ¥Ñ0.167Ôºâ„Åß„Åô„Åå„ÄÅÂ∞ë„Å™„ÅÑË©¶Ë°åÂõûÊï∞„Åß„ÅØÂÅ∂ÁÑ∂„Å´„Çà„Çä„Å∞„Çâ„Å§„Åç„ÅåÂ§ß„Åç„Åè„Å™„Çä„Åæ„Åô„ÄÇ„Åó„Åã„Åó„ÄÅË©¶Ë°åÂõûÊï∞„ÇíÂ¢ó„ÇÑ„Åô„Å´„Å§„Çå„Å¶„ÄÅÂêÑÁõÆ„ÅÆÂá∫ÁèæÁ¢∫Áéá„ÅØ1/6„Å´ÂèéÊùü„Åó„Å¶„ÅÑ„Åè„Åì„Å®„ÅåË¶≥ÂØü„Åß„Åç„Åæ„Åô„ÄÇ</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // „ÉÅ„É£„Éº„Éà„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Çí‰øùÊåÅ„Åô„ÇãÂ§âÊï∞
        let resultsChart = null;
        let isRunning = false;
        
        // „Çµ„Ç§„Ç≥„É≠„ÅÆÁõÆ„ÇíË°®Á§∫„Åô„ÇãÈñ¢Êï∞
        function showDice(value) {
            const dots = document.querySelectorAll('.dot');
            // „Åô„Åπ„Å¶„ÅÆ„Éâ„ÉÉ„Éà„ÇíÈùûË°®Á§∫„Å´„Åô„Çã
            dots.forEach(dot => dot.style.opacity = '0');
            
            // Âá∫„ÅüÁõÆ„Å´Âøú„Åò„Å¶„Éâ„ÉÉ„Éà„ÇíË°®Á§∫
            switch(value) {
                case 1:
                    document.getElementById('dot5').style.opacity = '1';
                    break;
                case 2:
                    document.getElementById('dot1').style.opacity = '1';
                    document.getElementById('dot9').style.opacity = '1';
                    break;
                case 3:
                    document.getElementById('dot1').style.opacity = '1';
                    document.getElementById('dot5').style.opacity = '1';
                    document.getElementById('dot9').style.opacity = '1';
                    break;
                case 4:
                    document.getElementById('dot1').style.opacity = '1';
                    document.getElementById('dot3').style.opacity = '1';
                    document.getElementById('dot7').style.opacity = '1';
                    document.getElementById('dot9').style.opacity = '1';
                    break;
                case 5:
                    document.getElementById('dot1').style.opacity = '1';
                    document.getElementById('dot3').style.opacity = '1';
                    document.getElementById('dot5').style.opacity = '1';
                    document.getElementById('dot7').style.opacity = '1';
                    document.getElementById('dot9').style.opacity = '1';
                    break;
                case 6:
                    document.getElementById('dot1').style.opacity = '1';
                    document.getElementById('dot3').style.opacity = '1';
                    document.getElementById('dot4').style.opacity = '1';
                    document.getElementById('dot6').style.opacity = '1';
                    document.getElementById('dot7').style.opacity = '1';
                    document.getElementById('dot9').style.opacity = '1';
                    break;
            }
        }
        
        // „Çµ„Ç§„Ç≥„É≠„ÇíÊåØ„Çã„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
        function rollDice() {
            const dice = document.getElementById('dice');
            dice.classList.add('rolling');
            
            setTimeout(() => {
                dice.classList.remove('rolling');
                const value = Math.floor(Math.random() * 6) + 1;
                showDice(value);
            }, 1000);
        }
        
        // „Çµ„Ç§„Ç≥„É≠„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥Èñ¢Êï∞
        function diceSimulation(trials) {
            // ÁµêÊûú„ÇíË®òÈå≤„Åô„ÇãÈÖçÂàó
            const counts = {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0};
            const probabilities = {1: [], 2: [], 3: [], 4: [], 5: [], 6: []};
            const results = [];
            
            // „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÂÆüË°å
            for (let i = 1; i <= trials; i++) {
                const roll = Math.floor(Math.random() * 6) + 1;
                counts[roll]++;
                results.push(roll);
                
                // ÂêÑÁõÆ„ÅÆÁ¢∫Áéá„ÇíË®àÁÆó„Åó„Å¶Ë®òÈå≤
                for (let num = 1; num <= 6; num++) {
                    const prob = counts[num] / i;
                    probabilities[num].push(prob);
                }
                
                // ÈÄ≤Êçó„Éê„Éº„ÅÆÊõ¥Êñ∞
                if (i % Math.max(1, Math.floor(trials / 100)) === 0) {
                    document.getElementById('progress').style.width = `${(i / trials) * 100}%`;
                }
            }
            
            return { counts, probabilities, results };
        }
        
        // „Ç∞„É©„Éï„ÅÆÊõ¥Êñ∞
        function updateChart(probabilities, trials) {
            const ctx = document.getElementById('results-chart').getContext('2d');
            
            // Ë°®Á§∫„Åô„Çã„Éá„Éº„Çø„Éù„Ç§„É≥„Éà„ÅÆÈñìÂºï„Åç
            const maxPoints = 1000;
            const step = Math.max(1, Math.floor(trials / maxPoints));
            
            const datasets = [];
            const colors = [
                'rgba(255, 99, 132, 0.7)',
                'rgba(54, 162, 235, 0.7)',
                'rgba(255, 206, 86, 0.7)',
                'rgba(75, 192, 192, 0.7)',
                'rgba(153, 102, 255, 0.7)',
                'rgba(255, 159, 64, 0.7)'
            ];
            
            for (let num = 1; num <= 6; num++) {
                const data = [];
                for (let i = 0; i < probabilities[num].length; i += step) {
                    data.push(probabilities[num][i]);
                }
                // ÊúÄÂæå„ÅÆ„Éù„Ç§„É≥„Éà„ÇíÂøÖ„ÅöÂê´„ÇÅ„Çã
                if (probabilities[num].length > 0 && (probabilities[num].length - 1) % step !== 0) {
                    data.push(probabilities[num][probabilities[num].length - 1]);
                }
                
                datasets.push({
                    label: `${num}„ÅÆÁõÆ`,
                    data: data,
                    borderColor: colors[num - 1],
                    backgroundColor: colors[num - 1].replace('0.7', '0.1'),
                    borderWidth: 2,
                    pointRadius: 0,
                    pointHoverRadius: 3,
                    tension: 0.1
                });
            }
            
            // Êó¢Â≠ò„ÅÆ„ÉÅ„É£„Éº„Éà„Åå„ÅÇ„Çå„Å∞Á†¥Ê£Ñ
            if (resultsChart) {
                resultsChart.destroy();
            }
            
            // Êñ∞„Åó„ÅÑ„ÉÅ„É£„Éº„Éà„Çí‰ΩúÊàê
            resultsChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({ length: Math.ceil(trials / step) }, (_, i) => (i * step) + 1),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 0
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 0.3,
                            title: {
                                display: true,
                                text: 'Á¢∫Áéá',
                                font: {
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return (value * 100).toFixed(1) + '%';
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Ë©¶Ë°åÂõûÊï∞',
                                font: {
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: '„Çµ„Ç§„Ç≥„É≠„ÅÆÁ¢∫ÁéáÂèéÊùü„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥',
                            font: {
                                size: 18,
                                weight: 'bold'
                            },
                            padding: {
                                bottom: 20
                            }
                        },
                        annotation: {
                            annotations: {
                                line1: {
                                    type: 'line',
                                    yMin: 1/6,
                                    yMax: 1/6,
                                    borderColor: 'rgba(231, 76, 60, 0.8)',
                                    borderWidth: 2,
                                    borderDash: [6, 6],
                                    label: {
                                        content: 'ÁêÜË´ñÂÄ§ (1/6 = 16.7%)',
                                        enabled: true,
                                        position: 'end'
                                    }
                                }
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += (context.parsed.y * 100).toFixed(2) + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Áµ±Ë®àÊÉÖÂ†±„ÅÆÊõ¥Êñ∞
        function updateStats(counts, trials) {
            const statsContainer = document.getElementById('stats-container');
            
            let statsHTML = `<h3>Á¢∫ÁéáÁµ±Ë®à (${trials}Âõû)</h3>`;
            statsHTML += `<table class="probability-table">
                <tr>
                    <th>ÁõÆ</th>
                    <th>ÂõûÊï∞</th>
                    <th>Á¢∫Áéá</th>
                    <th>ÁêÜË´ñÂÄ§„Å®„ÅÆÂ∑Æ</th>
                </tr>`;
            
            for (let num = 1; num <= 6; num++) {
                const count = counts[num];
                const probability = count / trials;
                const diff = Math.abs(probability - 1/6);
                
                statsHTML += `<tr>
                    <td>${num}</td>
                    <td>${count}Âõû</td>
                    <td>${(probability * 100).toFixed(2)}%</td>
                    <td>${(diff * 100).toFixed(2)}%</td>
                </tr>`;
            }
            
            statsHTML += `</table>`;
            statsHTML += `<p class="theoretical">ÁêÜË´ñÂÄ§: 1/6 = 16.67%</p>`;
            statsHTML += `<p>Â§ßÊï∞„ÅÆÊ≥ïÂâá„Å´„Çà„Çä„ÄÅË©¶Ë°åÂõûÊï∞„ÅåÂ¢ó„Åà„Çã„Åª„Å©ÂêÑÁõÆ„ÅÆÂá∫ÁèæÁ¢∫Áéá„ÅØÁêÜË´ñÂÄ§„Å´Ëøë„Å•„Åç„Åæ„Åô„ÄÇ</p>`;
            
            statsContainer.innerHTML = statsHTML;
        }
        
        // „Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÂÆüË°å
        async function runSimulation() {
            if (isRunning) return;
            
            isRunning = true;
            const trials = parseInt(document.getElementById('trials').value);
            
            if (isNaN(trials) || trials < 10) {
                alert('ÊúâÂäπ„Å™Ë©¶Ë°åÂõûÊï∞„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà10‰ª•‰∏äÔºâ');
                isRunning = false;
                return;
            }
            
            // ÈÄ≤Êçó„Éê„Éº„Çí„É™„Çª„ÉÉ„Éà
            document.getElementById('progress').style.width = '0%';
            
            // „Çµ„Ç§„Ç≥„É≠„ÇíÊåØ„Çã„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
            rollDice();
            
            // ÈùûÂêåÊúü„Åß„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÂÆüË°å
            setTimeout(() => {
                const { counts, probabilities } = diceSimulation(trials);
                
                // „Ç∞„É©„Éï„Å®Áµ±Ë®à„ÅÆÊõ¥Êñ∞
                updateChart(probabilities, trials);
                updateStats(counts, trials);
                
                isRunning = false;
            }, 1200);
        }
        
        // „É™„Çª„ÉÉ„Éà„Éú„Çø„É≥„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        document.getElementById('reset-btn').addEventListener('click', () => {
            document.getElementById('trials').value = 1000;
            document.getElementById('stats-container').innerHTML = '<h3>Á¢∫ÁéáÁµ±Ë®à</h3><p>„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>';
            document.getElementById('progress').style.width = '0%';
            
            // „ÉÅ„É£„Éº„Éà„Çí„É™„Çª„ÉÉ„Éà
            if (resultsChart) {
                resultsChart.destroy();
                resultsChart = null;
            }
            
            // „Çµ„Ç§„Ç≥„É≠„Çí„É™„Çª„ÉÉ„Éà
            const dots = document.querySelectorAll('.dot');
            dots.forEach(dot => dot.style.opacity = '0');
        });
        
        // ÂÆüË°å„Éú„Çø„É≥„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        document.getElementById('run-btn').addEventListener('click', runSimulation);
        
        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„ÅÆÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            // „Çµ„Ç§„Ç≥„É≠„ÅÆÂàùÊúüË°®Á§∫
            showDice(1);
        });
    </script>
</body>
</html>

